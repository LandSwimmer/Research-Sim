<!DOCTYPE html>
<html>
<head>
  <title>Research Simulator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin:0; font-family:'Segoe UI',sans-serif; background:#121212; color:#eee; display:flex; justify-content:center; align-items:center; min-height:100vh; padding:10px; }
    .container { width:100%; max-width:600px; background:#1f1f1f; padding:25px; border-radius:15px; box-shadow:0 0 25px rgba(0,0,0,0.5); }
    h2{ margin-top:0; font-weight:500; font-size:1.4rem; text-align:center; }
    p{ font-size:1rem; line-height:1.5; text-align:center; white-space:pre-line; }
    .options{ display:flex; flex-wrap:wrap; justify-content:center; margin:15px 0; }
    .option-btn{ display:flex; flex-direction:column; align-items:center; justify-content:center; margin:5px; padding:12px; background:#4CAF50; color:white; border-radius:12px; cursor:pointer; flex:1 1 40%; min-width:120px; font-size:0.95rem; transition:all 0.2s ease; }
    .option-btn:hover{ opacity:0.85; }
    #progressBar{ width:100%; background:#333; height:14px; border-radius:12px; overflow:hidden; margin:15px 0; }
    #progressFill{ height:100%; width:0%; background:#4CAF50; border-radius:12px; transition:width 0.4s; }
    .result{ background:#222; padding:12px; border-radius:10px; text-align:center; font-size:0.95rem; margin-top:12px; }
    .hidden{ display:none; }
    @media(max-width:480px){ .option-btn{ flex:1 1 80%; } }
  </style>
</head>
<body>

<div class="container">
  <h2 id="stageTitle">Research Simulator</h2>
  <p id="stageText">Select a difficulty level to start:</p>
  <div class="options" id="options">
    <div class="option-btn" onclick="startGame('easy')">Easy</div>
    <div class="option-btn" onclick="startGame('medium')">Medium</div>
    <div class="option-btn" onclick="startGame('hard')">Hard</div>
  </div>
  <div id="progressBar"><div id="progressFill"></div></div>
  <div class="result hidden" id="resultBox"></div>
</div>

<script>
let stage = 0;
let engagementScore = 0;
let difficulty = 'easy';
let answersChosen = [];
let research = { problem:"", rrl:"", question:"", design:"", sample:0, instrument:"Likert Scale", meanScore:0, recommendation:"" };

// Game data with unique problems and choices per difficulty
const stagesData = {
  easy: [
    {title:"Introduction", text:"Scenario: Many students skip submitting research assignments and struggle to understand research concepts. Identify the research problem.", options:["Many students struggle with research concepts affecting engagement","Classroom walls affect learning","Cafeteria menu affects attention"], correct:0},
    {title:"RRL", text:"Which literature supports your problem?", options:["Interactive tools improve engagement","Sports performance affects grades","Cafeteria food affects attention"], correct:0},
    {title:"Statement of the Problem", text:"What is your research question?", options:["Does the Research Simulator improve engagement?","How many pencils are used?"], correct:0},
    {title:"Design", text:"Choose a research design:", options:["Quantitative Descriptive","Qualitative Interview","Experimental"], correct:0},
    {title:"Participants", text:"How many students will participate?", options:["10","30","100"], correct:1},
    {title:"Data Gathering", text:"Choose the instrument:", options:["Yes/No Survey","Likert Scale","Essay Responses"], correct:1},
    {title:"Results", text:"", options:[], correct:0},
    {title:"Recommendation", text:"", options:[], correct:0}
  ],
  medium: [
    {title:"Introduction", text:"Scenario: ICT students spend more time on mobile games than completing research projects, reducing their participation. Identify the research problem.", options:["Students have difficulty managing time for research activities","Students get distracted during online classes","Students prefer mobile games over research"], correct:0},
    {title:"RRL", text:"Which literature is relevant?", options:["Interactive tools improve engagement","Sports affect grades","Cafeteria food"], correct:0},
    {title:"Statement of the Problem", text:"Formulate the research question.", options:["Does the Research Simulator improve student engagement?","How many pencils?"], correct:0},
    {title:"Design", text:"Choose the research design.", options:["Quantitative Descriptive","Qualitative Interview","Experimental"], correct:0},
    {title:"Participants", text:"Who are your participants?", options:["Grade 12 ICT students","All students","Teachers"], correct:0},
    {title:"Data Gathering", text:"Select the data collection instrument.", options:["Yes/No Survey","Likert Scale","Essay Responses"], correct:1},
    {title:"Results", text:"", options:[], correct:0},
    {title:"Recommendation", text:"", options:[], correct:0}
  ],
  hard: [
    {title:"Introduction", text:"Scenario: Grade 12 ICT students consistently show low engagement and struggle with understanding complex research methodology concepts, affecting research output. Identify the research problem.", options:["Students demonstrate low engagement in research due to difficulty understanding research methodology","Students do not follow classroom rules","Students are absent during PE class"], correct:0},
    {title:"RRL", text:"Which study is relevant?", options:["Gamified web-based tools increase engagement","Sports affect grades","Cafeteria food"], correct:0},
    {title:"Statement of the Problem ", text:"Formulate the research question.", options:["To what extent does the Research Simulator improve engagement?","How many pencils?"], correct:0},
    {title:"Design", text:"Choose the research design.", options:["Quantitative Descriptive","Qualitative Interview","Experimental"], correct:0},
    {title:"Participants", text:"Who are the participants?", options:["Grade 12 ICT students","All students","Teachers"], correct:0},
    {title:"Data Gathering", text:"Select the data collection instrument.", options:["Yes/No Survey","Likert Scale","Essay Responses"], correct:1},
    {title:"Results", text:"", options:[], correct:0},
    {title:"Recommendation", text:"", options:[], correct:0}
  ]
};

function startGame(level){
  difficulty = level;
  stage = 0;
  engagementScore = 0;
  answersChosen = [];
  research.sample = 30;
  research.instrument = "Likert Scale";
  renderStage();
}

function renderStage(){
  const title = document.getElementById("stageTitle");
  const text = document.getElementById("stageText");
  const optionsDiv = document.getElementById("options");
  const resultBox = document.getElementById("resultBox");
  const progressFill = document.getElementById("progressFill");

  optionsDiv.innerHTML="";
  resultBox.classList.add("hidden");
  progressFill.style.width = `${(stage/stagesData[difficulty].length)*100}%`;

  if(stage >= stagesData[difficulty].length){
    title.innerText="Simulation Completed!";
    text.innerText=`Your engagement score: ${engagementScore}`;
    optionsDiv.innerHTML=`
      <div class="option-btn" onclick="showAnswers()">Show Correct Answers</div>
      <div class="option-btn" onclick="goHome()">Exit to Home</div>`;
    return;
  }

  const current = stagesData[difficulty][stage];

  // Stage 7: Results scenario
  if(stage === 6){
    title.innerText = "Stage 7: Results / Data Analysis";
    research.meanScore = (Math.random()*2+2).toFixed(2); // Simulated mean
    text.innerText=`Scenario: You conducted your research with ${research.sample} students using ${research.instrument}.\n\nThe mean engagement score was ${research.meanScore} out of 5.\nMost students reported difficulty understanding research concepts.`;
    optionsDiv.innerHTML=`<div class="option-btn" onclick="nextStage()">Proceed to Recommendation</div>`;
    return;
  }

  // Stage 8: Recommendation
  if(stage === 7){
    title.innerText = "Stage 8: Recommendation";
    text.innerText = "Based on the results scenario, which recommendation would you give to improve engagement?";
    optionsDiv.innerHTML=`
      <div class="option-btn" onclick="chooseRecommendation('Integrate interactive research simulators into curriculum', true)">Integrate interactive research simulators into curriculum</div>
      <div class="option-btn" onclick="chooseRecommendation('Ignore results', false)">Ignore results</div>
      <div class="option-btn" onclick="chooseRecommendation('Change classroom walls', false)">Change classroom walls</div>`;
    return;
  }

  // Normal stages
  title.innerText = `Stage ${stage+1}: ${current.title}`;
  text.innerText = current.text;
  current.options.forEach((opt,i)=>{
    const btn = document.createElement("div");
    btn.className="option-btn";
    btn.innerText=opt;
    btn.onclick=()=> chooseOption(i===current.correct, opt, current);
    optionsDiv.appendChild(btn);
  });
}

function chooseOption(correct, selected, current){
  answersChosen.push({stage: stage+1, question: current.text, selected: selected, correctAnswer: current.options[current.correct]});
  const resultBox=document.getElementById("resultBox");
  resultBox.classList.remove("hidden");
  resultBox.style.background=correct?"#4CAF50":"#f44336";
  resultBox.innerText=correct?"Good choice!":"This choice may affect your results.";
  if(correct) engagementScore+=10;
  setTimeout(()=>{ stage++; renderStage(); },1000);
}

function chooseRecommendation(choice, correct){
  answersChosen.push({
    stage: stage+1,
    question: "Recommendation based on results scenario",
    selected: choice,
    correctAnswer: "Integrate interactive research simulators into curriculum"
  });
  research.recommendation = choice;
  const resultBox=document.getElementById("resultBox");
  resultBox.classList.remove("hidden");
  resultBox.style.background=correct?"#4CAF50":"#f44336";
  resultBox.innerText=correct?"Good recommendation!":"This recommendation does not address the results.";
  if(correct) engagementScore+=10;
  setTimeout(()=>{ stage++; renderStage(); },1500);
}

function nextStage(){ stage++; renderStage(); }

function showAnswers(){
  const container = document.querySelector(".container");
  container.innerHTML="<h2>Correct Answers Summary</h2>";
  answersChosen.forEach(ans=>{
    container.innerHTML += `
      <p><strong>Stage ${ans.stage}</strong>: ${ans.question}<br>
      Your Answer: ${ans.selected}<br>
      Correct Answer: ${ans.correctAnswer}</p><hr>`;
  });
  container.innerHTML += `<div class="option-btn" onclick="goHome()">Exit to Home</div>`;
}

function goHome(){ location.reload(); }

</script>
</body>
</html>